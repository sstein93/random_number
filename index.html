<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Spin the Wheel</title>
  <style>
    :root { --bg1:#0b1020; --bg2:#1a1f3a; --card:#0f1630cc; --text:#eef2ff; --muted:#aab3d6; }
    * { box-sizing: border-box; }
    body{
      margin:0; min-height:100vh; display:grid; place-items:center;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      color:var(--text);
      background: radial-gradient(1200px 800px at 20% 20%, #2b3a8a55, transparent 60%),
                  radial-gradient(1000px 700px at 80% 30%, #b833ff33, transparent 55%),
                  linear-gradient(135deg, var(--bg1), var(--bg2));
    }
    .wrap{
      width:min(920px, 92vw);
      display:grid;
      grid-template-columns: 1.2fr 0.8fr;
      gap:24px;
      align-items:center;
      padding:24px;
    }
    @media (max-width: 820px){
      .wrap{ grid-template-columns: 1fr; }
    }
    .card{
      background: var(--card);
      border: 1px solid #ffffff1a;
      box-shadow: 0 20px 60px #00000055;
      border-radius: 24px;
      padding: 22px;
      backdrop-filter: blur(10px);
    }
    h1{ margin:0 0 8px 0; font-size: 28px; letter-spacing: -0.02em; }
    p{ margin:0; color: var(--muted); line-height: 1.5; }
    .wheel-area{
      display:grid;
      place-items:center;
      position:relative;
      padding: 18px;
    }
    canvas{
      width: min(440px, 78vw);
      height: min(440px, 78vw);
      max-width: 440px;
      max-height: 440px;
      border-radius: 999px;
      box-shadow: 0 18px 50px #00000066;
      background: #0b1020;
    }
    .pointer{
      position:absolute;
      top: 6px;
      width:0; height:0;
      border-left: 18px solid transparent;
      border-right: 18px solid transparent;
      border-bottom: 32px solid #ffffff;
      filter: drop-shadow(0 6px 8px #00000088);
    }
    .pointer::after{
      content:"";
      position:absolute;
      left:-10px; top: 10px;
      width:20px; height:20px;
      background:#0b1020;
      border-radius:999px;
      border: 2px solid #ffffff;
    }
    .controls{
      display:grid;
      gap:14px;
    }
    .btn{
      border:0;
      border-radius: 16px;
      padding: 14px 16px;
      font-weight: 700;
      font-size: 16px;
      cursor:pointer;
      color:#0b1020;
      background: linear-gradient(135deg, #f6ff7a, #7affd7, #7aa6ff);
      box-shadow: 0 14px 35px #00000055;
    }
    .btn:disabled{ opacity:0.55; cursor:not-allowed; }
    .row{
      display:flex; gap:10px; flex-wrap:wrap;
    }
    input{
      flex:1;
      min-width: 130px;
      background:#0b1020cc;
      border: 1px solid #ffffff22;
      color: var(--text);
      border-radius: 14px;
      padding: 12px 12px;
      outline:none;
    }
    label{
      font-size: 12px;
      color: var(--muted);
      display:block;
      margin: 6px 0 6px 2px;
    }
    .result{
      border-radius: 18px;
      padding: 14px;
      background:#0b1020aa;
      border: 1px solid #ffffff1a;
    }
    .big{
      font-size: 34px;
      font-weight: 900;
      letter-spacing: -0.02em;
      margin-top: 6px;
    }
    .tiny{ font-size: 12px; color: var(--muted); margin-top: 6px; }
    .pill{
      display:inline-flex; align-items:center; gap:8px;
      padding: 8px 10px;
      border-radius: 999px;
      background:#0b1020aa;
      border: 1px solid #ffffff1a;
      color: var(--muted);
      font-size: 12px;
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card wheel-area">
      <div class="pointer" aria-hidden="true"></div>
      <canvas id="wheel" width="700" height="700"></canvas>
    </div>

    <div class="card controls">
      <div>
        <h1>Spin the Wheel ðŸŽ¡</h1>
      </div>

      <button id="spin" class="btn">SPIN</button>

      <div class="result">
        <div class="tiny">Result</div>
        <div id="result" class="big">â€”</div>
        <div id="meta" class="tiny">Set a range and spin.</div>
      </div>
    </div>
  </div>

  <script>
    // --- Wheel + spin logic ---
    const canvas = document.getElementById("wheel");
    const ctx = canvas.getContext("2d");
    const spinBtn = document.getElementById("spin");
    // Set your wheel range here
    const FIXED_MIN = 1;
    const FIXED_MAX = 300;
    const resultEl = document.getElementById("result");
    const metaEl = document.getElementById("meta");

    let angle = 0;              // current wheel rotation in radians
    let isSpinning = false;

    function clampInt(x, fallback){
      const n = Number.parseInt(x, 10);
      return Number.isFinite(n) ? n : fallback;
    }

    function rangeValues(){
      const values = [];
      for (let v = FIXED_MIN; v <= FIXED_MAX; v++) {
        values.push(v);
      }
      return values;
    }

    function hslColor(i, n){
      // evenly spaced hues; looks colorful without you hand-picking colors
      const hue = (i * (360 / n) + 210) % 360;
      return `hsl(${hue} 85% 60%)`;
    }

    function drawWheel(values){
      const n = values.length;

      const cx = canvas.width/2;
      const cy = canvas.height/2;
      const r  = Math.min(cx, cy) - 18;

      ctx.clearRect(0,0,canvas.width,canvas.height);

      // background ring
      ctx.save();
      ctx.translate(cx, cy);
      ctx.rotate(angle);

      const step = (Math.PI * 2) / n;

      for (let i=0; i<n; i++){
        const start = i * step;
        const end = start + step;

        // slice
        ctx.beginPath();
        ctx.moveTo(0,0);
        ctx.arc(0,0, r, start, end);
        ctx.closePath();
        ctx.fillStyle = hslColor(i, n);
        ctx.fill();

        // slice border
        ctx.strokeStyle = "rgba(255,255,255,0.25)";
        ctx.lineWidth = 3;
        ctx.stroke();

        // text (only show if <= 50 segments)
        if (n <= 50) {
          ctx.save();
          ctx.rotate(start + step/2);
          ctx.textAlign = "right";
          ctx.fillStyle = "rgba(10,16,32,0.92)";
          ctx.font = "900 44px ui-sans-serif, system-ui";
          ctx.fillText(String(values[i]), r - 24, 16);
          ctx.restore();
        }
      }

      // center cap
      ctx.beginPath();
      ctx.arc(0,0, 60, 0, Math.PI*2);
      ctx.fillStyle = "rgba(11,16,32,0.92)";
      ctx.fill();
      ctx.strokeStyle = "rgba(255,255,255,0.35)";
      ctx.lineWidth = 4;
      ctx.stroke();

      ctx.fillStyle = "rgba(238,242,255,0.92)";
      ctx.font = "900 34px ui-sans-serif, system-ui";
      ctx.textAlign = "center";

      ctx.restore();
    }

    // pointer is fixed at the top (12 o'clock). Determine which segment is under it.
    function pickFromAngle(values){
      const n = values.length;
      const step = (Math.PI * 2) / n;

      // With our drawing, angle rotates wheel; pointer is at -90deg (top).
      // Convert to wheel space: where is "top" on the wheel given current angle?
      const top = (Math.PI * 1.5 - angle) % (Math.PI * 2); // 1.5Ï€ = -Ï€/2 normalized
      const idx = Math.floor((top + Math.PI*2) % (Math.PI*2) / step);
      return { idx, value: values[idx] };
    }

    function easeOutCubic(t){ return 1 - Math.pow(1 - t, 3); }

    function spin(){
      if (isSpinning) return;
      const values = rangeValues();
      if (values.length < 2){
        resultEl.textContent = String(values[0] ?? "â€”");
        metaEl.textContent = "Range must include at least 2 numbers to spin.";
        return;
      }

      isSpinning = true;
      spinBtn.disabled = true;
      resultEl.textContent = "â€¦";
      metaEl.textContent = "Spinningâ€¦";

      // Random target segment and extra rotations for drama
      const n = values.length;
      const targetIndex = Math.floor(Math.random() * n);

      // We want the wheel to stop with targetIndex at the top pointer.
      const step = (Math.PI * 2) / n;

      // The angle that puts targetIndex at top (12 o'clock). Derived from pickFromAngle().
      // top = 1.5Ï€ - angle => targetIndex*step <= top < (targetIndex+1)*step
      // We'll aim at the center of the target slice:
      const targetTop = (targetIndex + 0.5) * step;
      let targetAngle = (Math.PI * 1.5 - targetTop);

      // Normalize and add extra spins
      const extraSpins = 6 + Math.floor(Math.random() * 4); // 6â€“9 spins
      targetAngle += extraSpins * Math.PI * 2;

      const start = angle;
      const delta = targetAngle - start;

      const duration = 2200 + Math.random()*800; // 2.2â€“3.0s
      const t0 = performance.now();

      function frame(now){
        const t = Math.min(1, (now - t0) / duration);
        angle = start + delta * easeOutCubic(t);
        drawWheel(values);

        if (t < 1){
          requestAnimationFrame(frame);
        } else {
          // Snap and report
          const picked = pickFromAngle(values);
          resultEl.textContent = String(picked.value);
          metaEl.textContent = `Landed on segment ${picked.idx + 1} of ${values.length}.`;
          isSpinning = false;
          spinBtn.disabled = false;
        }
      }
      requestAnimationFrame(frame);
    }

    // redraw on range changes
    function refresh(){
      const values = rangeValues();
      drawWheel(values);
      const picked = pickFromAngle(values);
      metaEl.textContent = `Current top: ${picked.value}`;
    }

    spinBtn.addEventListener("click", spin);

    // initial draw
    refresh();

    // OPTIONAL: auto-spin on page load (nice for QR scans)
    const AUTO_SPIN_ON_LOAD = true;
    if (AUTO_SPIN_ON_LOAD) setTimeout(spin, 250);
  </script>
</body>
</html>
